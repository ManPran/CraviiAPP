import type { IngredientLegacy } from "@shared/schema";

// Legacy ingredients for backward compatibility during migration
export const savoryIngredients: IngredientLegacy[] = [
  {
    id: "onions",
    name: "Yellow Onions",
    description: "Essential for almost every savory dish",
    imageUrl: "https://images.unsplash.com/photo-1518977676601-b53f82aba655?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["vegetables", "aromatic", "essential"],
    category: "vegetables"
  },
  {
    id: "garlic",
    name: "Fresh Garlic",
    description: "Aromatic and flavorful, essential for cooking",
    imageUrl: "https://images.unsplash.com/photo-1513637785636-ad7f1adb6d86?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["aromatics", "flavor", "essential"],
    category: "aromatics"
  },
  {
    id: "potatoes",
    name: "Russet Potatoes",
    description: "Versatile starchy vegetable, perfect for any meal",
    imageUrl: "https://images.unsplash.com/photo-1598170845058-32b9d6a5da37?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["vegetables", "starchy", "versatile"],
    category: "vegetables"
  },
  {
    id: "carrots",
    name: "Carrots",
    description: "Sweet and crunchy, great for roasting or salads",
    imageUrl: "https://images.unsplash.com/photo-1598170845058-32b9d6a5da37?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["vegetables", "sweet", "crunchy"],
    category: "vegetables"
  },
  {
    id: "eggs",
    name: "Large Eggs",
    description: "Perfect protein for breakfast, lunch or dinner",
    imageUrl: "https://images.unsplash.com/photo-1582722872445-44dc5f7e3c8f?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["protein", "versatile", "breakfast"],
    category: "protein"
  },
  {
    id: "chicken",
    name: "Chicken Breast",
    description: "Lean protein, versatile for many dishes",
    imageUrl: "https://images.unsplash.com/photo-1544500097-6dcb998b5dc2?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["poultry", "protein", "lean"],
    category: "protein"
  },
  {
    id: "ground-beef",
    name: "Ground Beef",
    description: "Perfect for tacos, burgers, and pasta sauces",
    imageUrl: "https://images.unsplash.com/photo-1588347818111-d8da1b2c3e96?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["meat", "protein", "versatile"],
    category: "protein"
  },
  {
    id: "rice",
    name: "White Rice",
    description: "Staple grain that pairs with everything",
    imageUrl: "https://images.unsplash.com/photo-1586201375761-83865001e67c?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["grains", "staple", "filling"],
    category: "grains"
  },
  {
    id: "pasta",
    name: "Spaghetti Pasta",
    description: "Classic pasta for quick and easy meals",
    imageUrl: "https://images.unsplash.com/photo-1621996346565-e3dbc353d2e5?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["grains", "pasta", "quick"],
    category: "grains"
  },
  {
    id: "cheese",
    name: "Cheddar Cheese",
    description: "Sharp and creamy, perfect for melting",
    imageUrl: "https://images.unsplash.com/photo-1586511925558-a4c6376fe65f?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["dairy", "creamy", "melting"],
    category: "dairy"
  },
  {
    id: "tomatoes",
    name: "Roma Tomatoes",
    description: "Fresh and juicy, perfect for sauces and salads",
    imageUrl: "https://images.unsplash.com/photo-1592841200221-a6898f307baa?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["vegetables", "fresh", "vitamin-c"],
    category: "vegetables"
  },
  {
    id: "bell-peppers",
    name: "Bell Peppers",
    description: "Colorful and crunchy, great for stir-fries",
    imageUrl: "https://images.unsplash.com/photo-1563565375-f3fdfdbefa83?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["vegetables", "colorful", "vitamin-c"],
    category: "vegetables"
  },
  {
    id: "broccoli",
    name: "Fresh Broccoli",
    description: "Nutrient-dense cruciferous vegetable",
    imageUrl: "https://images.unsplash.com/photo-1459411621453-7b03977f4bfc?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["vegetables", "healthy", "fiber"],
    category: "vegetables"
  },
  {
    id: "spinach",
    name: "Baby Spinach",
    description: "Fresh leafy greens, rich in iron and vitamins",
    imageUrl: "https://images.unsplash.com/photo-1576045057995-568f588f82fb?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["vegetables", "leafy", "healthy"],
    category: "vegetables"
  },
  {
    id: "mushrooms",
    name: "Button Mushrooms",
    description: "Earthy flavor, great for umami dishes",
    imageUrl: "https://images.unsplash.com/photo-1518864286750-6c28b35ec006?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["vegetables", "umami", "earthy"],
    category: "vegetables"
  },
  {
    id: "bread",
    name: "Whole Wheat Bread",
    description: "Perfect for sandwiches, toast, and breadcrumbs",
    imageUrl: "https://images.unsplash.com/photo-1509440159596-0249088772ff?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["grains", "bread", "versatile"],
    category: "grains"
  },
  {
    id: "butter",
    name: "Unsalted Butter",
    description: "Essential for cooking and baking",
    imageUrl: "https://images.unsplash.com/photo-1589985270826-4b7bb135bc9d?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["dairy", "cooking", "baking"],
    category: "dairy"
  },
  {
    id: "olive-oil",
    name: "Extra Virgin Olive Oil",
    description: "Healthy cooking oil with great flavor",
    imageUrl: "https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["oils", "healthy", "cooking"],
    category: "oils"
  },
  {
    id: "lemon",
    name: "Fresh Lemons",
    description: "Bright citrus for flavor and freshness",
    imageUrl: "https://images.unsplash.com/photo-1571771894821-ce9b6c11b08e?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["citrus", "fresh", "acidic"],
    category: "fruits"
  },
  {
    id: "black-pepper",
    name: "Black Pepper",
    description: "Essential spice for seasoning",
    imageUrl: "https://images.unsplash.com/photo-1596040033229-a9821ebd058d?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["spices", "seasoning", "essential"],
    category: "spices"
  },
  {
    id: "salt",
    name: "Sea Salt",
    description: "The most important seasoning in cooking",
    imageUrl: "https://images.unsplash.com/photo-1587735243474-68e9c4c96dc3?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["seasoning", "essential", "mineral"],
    category: "seasoning"
  }
];

export const sweetIngredients: IngredientLegacy[] = [
  {
    id: "sugar",
    name: "Granulated Sugar",
    description: "Essential sweetener for baking and desserts",
    imageUrl: "https://images.unsplash.com/photo-1587735243474-68e9c4c96dc3?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["sweetener", "baking", "essential"],
    category: "sweeteners"
  },
  {
    id: "flour",
    name: "All-Purpose Flour",
    description: "Basic ingredient for cakes, cookies, and breads",
    imageUrl: "https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["baking", "flour", "essential"],
    category: "baking"
  },
  {
    id: "eggs",
    name: "Large Eggs",
    description: "Essential for binding and structure in baking",
    imageUrl: "https://images.unsplash.com/photo-1582722872445-44dc5f7e3c8f?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["protein", "baking", "binding"],
    category: "protein"
  },
  {
    id: "butter",
    name: "Unsalted Butter",
    description: "Creates rich flavor and tender texture",
    imageUrl: "https://images.unsplash.com/photo-1589985270826-4b7bb135bc9d?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["dairy", "baking", "rich"],
    category: "dairy"
  },
  {
    id: "milk",
    name: "Whole Milk",
    description: "Adds moisture and richness to baked goods",
    imageUrl: "https://images.unsplash.com/photo-1563636619-e9143da7973b?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["dairy", "liquid", "creamy"],
    category: "dairy"
  },
  {
    id: "vanilla",
    name: "Vanilla Extract",
    description: "Classic flavoring for cookies and cakes",
    imageUrl: "https://images.unsplash.com/photo-1571115764595-644a1f56a55c?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["extract", "flavoring", "sweet"],
    category: "flavorings"
  },
  {
    id: "chocolate-chips",
    name: "Chocolate Chips",
    description: "Perfect for cookies, muffins, and pancakes",
    imageUrl: "https://images.unsplash.com/photo-1606312619070-d48b4c652a52?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["chocolate", "sweet", "baking"],
    category: "chocolate"
  },
  {
    id: "baking-powder",
    name: "Baking Powder",
    description: "Leavening agent for fluffy cakes and muffins",
    imageUrl: "https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["leavening", "baking", "essential"],
    category: "baking"
  },
  {
    id: "cinnamon",
    name: "Ground Cinnamon",
    description: "Warm spice perfect for cookies and pastries",
    imageUrl: "https://images.unsplash.com/photo-1506368670156-28b14e8f1e94?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["spices", "warm", "sweet"],
    category: "spices"
  },
  {
    id: "bananas",
    name: "Ripe Bananas",
    description: "Natural sweetness for breads and smoothies",
    imageUrl: "https://images.unsplash.com/photo-1603833665858-e61d17a86224?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["fruits", "sweet", "natural"],
    category: "fruits"
  },
  {
    id: "brown-sugar",
    name: "Brown Sugar",
    description: "Adds molasses flavor to cookies and cakes",
    imageUrl: "https://images.unsplash.com/photo-1587735243474-68e9c4c96dc3?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["sweetener", "molasses", "rich"],
    category: "sweeteners"
  },
  {
    id: "honey",
    name: "Pure Honey",
    description: "Natural liquid sweetener for tea and baking",
    imageUrl: "https://images.unsplash.com/photo-1587049352846-4a222e784d38?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["sweetener", "natural", "liquid"],
    category: "sweeteners"
  },
  {
    id: "strawberries",
    name: "Fresh Strawberries",
    description: "Sweet berries perfect for desserts and jams",
    imageUrl: "https://images.unsplash.com/photo-1464965911861-746a04b4bca6?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["fruits", "berries", "fresh"],
    category: "fruits"
  },
  {
    id: "cream-cheese",
    name: "Cream Cheese",
    description: "Rich and tangy for frostings and cheesecakes",
    imageUrl: "https://images.unsplash.com/photo-1586511925558-a4c6376fe65f?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["dairy", "tangy", "rich"],
    category: "dairy"
  },
  {
    id: "powdered-sugar",
    name: "Powdered Sugar",
    description: "Fine sugar for frostings and dusting",
    imageUrl: "https://images.unsplash.com/photo-1587735243474-68e9c4c96dc3?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["sweetener", "fine", "frosting"],
    category: "sweeteners"
  },
  {
    id: "cocoa-powder",
    name: "Unsweetened Cocoa Powder",
    description: "Rich chocolate flavor for brownies and cakes",
    imageUrl: "https://images.unsplash.com/photo-1606312619070-d48b4c652a52?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["chocolate", "powder", "rich"],
    category: "chocolate"
  },
  {
    id: "oats",
    name: "Rolled Oats",
    description: "Hearty grain for cookies and breakfast treats",
    imageUrl: "https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["grains", "hearty", "texture"],
    category: "grains"
  },
  {
    id: "maple-syrup",
    name: "Pure Maple Syrup",
    description: "Natural sweetener for pancakes and baking",
    imageUrl: "https://images.unsplash.com/photo-1571115177098-24ec42ed204d?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["sweetener", "natural", "pancakes"],
    category: "sweeteners"
  },
  {
    id: "apples",
    name: "Granny Smith Apples",
    description: "Tart apples perfect for pies and crisps",
    imageUrl: "https://images.unsplash.com/photo-1570913149827-d2ac84ab3f9a?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["fruits", "tart", "baking"],
    category: "fruits"
  },
  {
    id: "nuts",
    name: "Chopped Walnuts",
    description: "Crunchy nuts for cookies and breads",
    imageUrl: "https://images.unsplash.com/photo-1448043552756-e747b7a2b2b8?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=200",
    tags: ["nuts", "crunchy", "texture"],
    category: "nuts"
  }
];

export function getIngredientsForTaste(taste: string): IngredientLegacy[] {
  return taste === "sweet" ? sweetIngredients : savoryIngredients;
}

// New API functions for database ingredients
export async function fetchIngredients() {
  const response = await fetch('/api/ingredients');
  if (!response.ok) throw new Error('Failed to fetch ingredients');
  return response.json();
}

export async function searchIngredients(query: string) {
  const response = await fetch(`/api/ingredients/search?q=${encodeURIComponent(query)}`);
  if (!response.ok) throw new Error('Failed to search ingredients');
  return response.json();
}

export async function fetchIngredientsByCategory(category: string) {
  const response = await fetch(`/api/ingredients/category/${category}`);
  if (!response.ok) throw new Error('Failed to fetch ingredients by category');
  return response.json();
}

export async function fetchIngredientsByPriority(priority: "main" | "complementary") {
  const response = await fetch(`/api/ingredients/priority/${priority}`);
  if (!response.ok) throw new Error('Failed to fetch ingredients by priority');
  return response.json();
}

export async function fetchRandomMainIngredient(tastePreference?: string, coursePreference?: string, rejectedIngredients?: string[], dietaryRestrictions?: string[]) {
  let url = '/api/ingredients/random-main';
  const params = new URLSearchParams();
  
  // Only add parameters if they have actual values (not empty strings)
  if (tastePreference && tastePreference.trim() !== '') {
    params.append('taste', tastePreference);
  }
  if (coursePreference && coursePreference.trim() !== '') {
    params.append('course', coursePreference);
  }
  if (rejectedIngredients && rejectedIngredients.length > 0) {
    // Deduplicate and stringify the rejected ingredients
    const uniqueRejected = [...new Set(rejectedIngredients)];
    params.append('rejected', JSON.stringify(uniqueRejected));
    console.log(`Sending ${uniqueRejected.length} rejected ingredients to API:`, uniqueRejected);
  }
  if (dietaryRestrictions && dietaryRestrictions.length > 0) {
    params.append('dietaryRestrictions', encodeURIComponent(JSON.stringify(dietaryRestrictions)));
    console.log(`Sending ${dietaryRestrictions.length} dietary restrictions to API:`, dietaryRestrictions);
  }
  
  if (params.toString()) {
    url += `?${params.toString()}`;
  }
  
  console.log(`Fetching main ingredient from: ${url}`);
  const response = await fetch(url);
  if (!response.ok) throw new Error('Failed to fetch random main ingredient');
  return response.json();
}

export async function fetchComplementaryIngredients(mainIngredient: string, limit: number = 20, tastePreference?: string) {
  let url = `/api/ingredients/complementary/${encodeURIComponent(mainIngredient)}?limit=${limit}`;
  if (tastePreference) {
    url += `&taste=${encodeURIComponent(tastePreference)}`;
  }
  const response = await fetch(url);
  if (!response.ok) throw new Error('Failed to fetch complementary ingredients');
  return response.json();
}
